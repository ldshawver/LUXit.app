- name: Deploy to VPS via SSH
  uses: appleboy/ssh-action@v1.0.3
  with:
    host: ${{ secrets.VPS_HOST }}
    username: ${{ secrets.VPS_USER }}
    key: ${{ secrets.VPS_SSH_KEY }}
    port: 22
    timeout: 30s
    command_timeout: 10m
    script: |
      set -e

      cd /opt/lux-marketing

      echo "ğŸ“¥ Fetching latest code"
      git fetch --all
      git reset --hard origin/main

      echo "ğŸ Activating virtualenv"
      source venv/bin/activate

      echo "ğŸ“¦ Installing dependencies"
      pip install --upgrade pip
      pip install -r requirements.txt

      echo "ğŸ”„ Restarting service"
      systemctl restart lux.service

      echo "âœ… Deployment complete"
